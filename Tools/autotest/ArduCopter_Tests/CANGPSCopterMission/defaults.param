# Parameters for CANGPSCopterMission test
# Increase EKF threshold to be more tolerant of variances
FS_EKF_THRESH 1.0

# GPS Configuration - Use DroneCAN GPS
GPS_TYPE 9
GPS_TYPE2 9
GPS1_CAN_OVRIDE 0
GPS2_CAN_OVRIDE 0

# GPS Configuration - Make GPS more reliable for testing
GPS_AUTO_CONFIG 1
GPS_AUTO_SWITCH 1
GPS_GNSS_MODE 65
GPS_SAVE_CFG 2
GPS_RATE_MS 200
GPS_RATE_MS2 200

# Simulation parameters to ensure GPS gets a good fix
SIM_GPS_NOISE 0
SIM_GPS_NUMSATS 14
SIM_GPS_GLITCH_X 0
SIM_GPS_GLITCH_Y 0
SIM_GPS_GLITCH_Z 0
SIM_GPS_POS_X 0
SIM_GPS_POS_Y 0
SIM_GPS_POS_Z 0
SIM_GPS_DELAY 0

# EKF parameters to make it more lenient
EK2_GPS_CHECK 0
EK3_GPS_CHECK 0
EK2_IMU_MASK 3
EK3_IMU_MASK 3

# Adjust EKF2 parameters to be more tolerant of sensor noise
EK2_ABIAS_P_NSE 0.005
EK2_GBIAS_P_NSE 0.0001
EK2_VELNE_M_NSE 0.5
EK2_VELD_M_NSE 0.5
EK2_POSNE_M_NSE 1.0
EK2_ALT_M_NSE 3.0

# Adjust EKF3 parameters (if used)
EK3_ABIAS_P_NSE 0.005
EK3_GBIAS_P_NSE 0.0001
EK3_VELNE_M_NSE 0.5
EK3_VELD_M_NSE 0.5
EK3_POSNE_M_NSE 1.0
EK3_ALT_M_NSE 3.0

# Increase innovation gate sizes to be more tolerant of outliers
EK2_VEL_I_GATE 700
EK2_POS_I_GATE 700
EK2_HGT_I_GATE 700
EK2_MAG_I_GATE 400

EK3_VEL_I_GATE 700
EK3_POS_I_GATE 700
EK3_HGT_I_GATE 700
EK3_MAG_I_GATE 400

# Disable all arming checks to make test more reliable
ARMING_CHECK 0
